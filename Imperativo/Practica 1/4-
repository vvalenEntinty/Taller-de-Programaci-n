program ejercicio;
const
max_rubro=8;
dimF= 30;
type
	rango_rubro=1..max_rubro; 
	
	producto=record
		codigo:integer;
		rubro:rango_rubro;
		precio:real;
	end;
	
	lista=^nodo;
		nodo=record
			dato:producto;
			sig:lista;
		end;
	
	vectorLista=array [rango_rubro] of lista;
	
	vector_Rubro3=array[1..dimF] of producto;
	
	procedure leerProducto (var p:producto);
	begin
		writeln('Ingresar el codigo');readln (p.codigo);
		writeln('Ingresar el rubro');readln(p.rubro);
		writeln('Ingresar el precio');readln(p.precio);
	end;
	
	procedure inicializarVectorListas (var v:vectorlista);
	var
		i:rango_rubro;
	begin
		for i:= 1 to max_rubro do
			v[i]:=nil;
	end;
	
	procedure insertarOrdenado (var l:lista; p:producto);
	var
	ant,act:lista;
		nue:lista;
	begin
		new(nue);
		nue^.dato:=p;
		ant:=l;
		act:=l;
		while (act <> nil) and (act^.dato.codigo<p.codigo) do
		begin
			ant:=act;
			act:=act^.sig;
		end;
		if (act = l) then
			l:=nue
			else
				ant^.sig:=nue;
			nue^.sig:=act;
		end;
	
	procedure cargarProductos (var v:vectorLista);
	var
		p:producto;
	begin
		inicializarVectorListas(v);
		LeerProducto(p);
		while (p.precio <> 0) do
		begin
			insertarOrdenado(v[p.rubro],p);
			LeerProducto(p);
		end;
	end;

procedure imprimir (v:vectorlista);
var
	i:integer;
begin
	for i := 1 to max_rubro do 
	begin
		writeln('------------- ',i,' ---------------');
		while (v[i]<> nil) do 
		begin
			writeln('codigo: ',v[i]^.dato.codigo);
			writeln('precio: ',v[i]^.dato.precio:0:2);
			v[i]:=v[i]^.sig;
		end;
	end;
end;

procedure cargarVectorR3 (v:vectorLista;var vecR3:vector_rubro3;var dimL:integer);
begin
	dimL:=0;
	
	while (v[3]<>nil) and (dimL < dimF)do 
	begin
		dimL:=dimL +1;
		vecR3[dimL]:=v[3]^.dato;
		v[3]:=v[3]^.sig;
	end;
end;

procedure ordenarVectorR3 (var v:vector_rubro3; dimL:integer);
var
	i,j,pos:integer;
	item:producto;
begin
	for i := 1 to dimL-1 do 
		pos:=i;
	begin
		for j:= i+1 to dimL do 
			if (v[j].precio < v[pos].precio) then
				pos:=j;
			item:=v[pos];
			v[pos]:=v[i];
			v[i]:=item;
		end;
	end;

procedure imprimirVectorR3 (v:vector_rubro3; dimL:integer);
var
	i:integer;
begin
	for i :=1 to dimL do 
	begin
		writeln('codigo ',v[i].codigo);
		writeln('rubro ',v[i].rubro);
		writeln('precio ',v[i].precio);
	end;
end;

function calcularPromedio (v:vector_rubro3; dimL:integer):real;
var
	totalPrecio:real;
	i:integer;
begin
	totalPrecio:=0;
	for i := 1 to dimL do 
		totalPrecio:=totalPrecio + v[i].precio;
	calcularPromedio:=(totalPrecio/dimL);
end;


var
	v:vectorlista;
	dimL:integer;
	vecR3:vector_rubro3;
begin
	cargarProductos(v); {punto A}
	imprimir (v); {punto B}
	cargarVectorR3(v,vecR3,dimL);
	ordenarVectorR3 (vecR3,dimL);
	imprimirVectorR3(vecR3,dimL);
	writeln ('El promedio de los precios es: ',calcularPromedio(vecR3,dimL):0:2);
end.
		
